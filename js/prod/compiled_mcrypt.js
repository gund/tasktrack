var mcrypt=mcrypt?mcrypt:new function(){var k={"rijndael-128":[16,32],"rijndael-192":[24,32],"rijndael-256":[32,32],serpent:[16,32]},g={"rijndael-128":function(g,l,m,k){32>m.length&&(m+=Array(33-m.length).join(String.fromCharCode(0)));k?Rijndael.Encrypt(l,m):Rijndael.Decrypt(l,m);return l}};g["rijndael-192"]=g["rijndael-128"];g["rijndael-256"]=g["rijndael-128"];g.serpent=function(g,l,m,k){k?Serpent.Encrypt(l):Serpent.Decrypt(l);return l};g.serpent.init=function(g,l,m){g=[];for(m=0;m<l.length;m++)g[m]=
l.charCodeAt(m);Serpent.Init(g)};g.serpent.deinit=function(g,m,k){Serpent.Close()};var r={Encrypt:function(g,m,k,p,q){return r.Crypt(!0,g,m,k,p,q)},Decrypt:function(g,m,k,p,q){return r.Crypt(!1,g,m,k,p,q)},Crypt:function(x,l,r,y,q,h){y?t=y:y=t;q?m=q:q=m;h?p=h:h=p;if(!l)return!0;g[q].init&&g[q].init(q,y,x);var n=k[q][0],a=n,c=Array(n);switch(h){case "cfb":a=1;case "cbc":case "ncfb":case "nofb":case "ctr":if(!r)throw"mcrypt.Crypt: IV Required for mode "+h;if(r.length!=n)throw"mcrypt.Crypt: IV must be "+
n+" characters long for "+q;for(n-=1;0<=n;n--)c[n]=r.charCodeAt(n);break;case "ecb":break;default:throw"mcrypt.Crypt: Unsupported mode of opperation"+p;}r=Math.ceil(l.length/a);var e=l.length;l+=Array(r*a-e+1).join(String.fromCharCode(0));var d="";switch(h){case "ecb":for(n=0;n<r;n++){for(h=0;h<a;h++)c[h]=l.charCodeAt(n*a+h);g[q](q,c,t,x);for(h=0;h<a;h++)d+=String.fromCharCode(c[h])}break;case "cbc":if(x)for(n=0;n<r;n++){for(h=0;h<a;h++)c[h]^=l.charCodeAt(n*a+h);g[q](q,c,t,!0);for(h=0;h<a;h++)d+=
String.fromCharCode(c[h])}else for(n=0;n<r;n++){var b=c,c=Array(a);for(h=0;h<a;h++)c[h]=l.charCodeAt(n*a+h);e=c.slice(0);g[q](q,e,t,!1);for(h=0;h<a;h++)d+=String.fromCharCode(b[h]^e[h])}break;case "cfb":for(n=0;n<r;n++)b=c.slice(0),g[q](q,b,t,!0),b=b[0]^l.charCodeAt(n),c.push(x?b:l.charCodeAt(n)),c.shift(),d+=String.fromCharCode(b);d=d.substr(0,e);break;case "ncfb":for(n=0;n<r;n++)for(g[q](q,c,t,!0),h=0;h<a;h++)b=l.charCodeAt(n*a+h),c[h]^=b,d+=String.fromCharCode(c[h]),x||(c[h]=b);d=d.substr(0,e);
break;case "nofb":for(n=0;n<r;n++)for(g[q](q,c,t,!0),h=0;h<a;h++)d+=String.fromCharCode(l.charCodeAt(n*a+h)^c[h]);d=d.substr(0,e);break;case "ctr":for(n=0;n<r;n++){b=c.slice(0);g[q](q,b,t,!0);for(h=0;h<a;h++)d+=String.fromCharCode(l.charCodeAt(n*a+h)^b[h]);h=1;b=a;do b--,c[b]+=1,h=c[b]>>8,c[b]&=255;while(h)}d=d.substr(0,e)}g[q].deinit&&g[q].deinit(q,y,x);return d},get_block_size:function(g,l){g||(g=m);return k[g]?k[g][0]:!1},get_cipher_name:function(g){g||(g=m);return k[g]?g:!1},get_iv_size:function(g,
l){g||(g=m);return k[g]?k[g][0]:!1},create_iv:function(g){for(var m="";g;--g)m+=String.fromCharCode(Math.floor(256*Math.random()));return m},get_key_size:function(g,l){g||(g=m);return k[g]?k[g][1]:!1},list_algorithms:function(){var g=[],m;for(m in k)g.push(m);return g},list_modes:function(){return"ecb cbc cfb ncfb nofb ctr".split(" ")}},p="cbc",m="rijndael-128",t="12345678911234567892123456789312";return r};var Rijndael=Rijndael?Rijndael:new function(){for(var k=[16,24,32],g=[[10,12,14],[12,12,14],[14,14,14]],r={},p=function(e,d,b){var f=e.length,l=d.length,k=0,s=0;switch(f){case 32:k++;case 24:k++;case 16:break;default:throw"rijndael: Unsupported block size: "+e.length;}switch(l){case 32:s++;case 24:s++;case 16:break;default:throw"rijndael: Unsupported key size: "+d.length;}l=g[k][s];if(!r[d]){var s=d.length,u=1;keyA=Array(480);for(var v=0;v<s;v++)keyA[v]=d.charCodeAt(v);for(v=s;480>v;v+=4){var p=keyA.slice(v-
4,v);0==v%s?(p=[m[p[1]]^u,m[p[2]],m[p[3]],m[p[0]]],256<=(u<<=1)&&(u^=283)):24<s&&16==v%s&&(p=[m[p[0]],m[p[1]],m[p[2]],m[p[3]]]);for(var t=0;4>t;t++)keyA[v+t]=keyA[v+t-s]^p[t]}r[d]=keyA}d=r[d];l*=f;if(b){a(e,d.slice(0,f));b=x[k];for(k=f;k<l;k+=f){n(e,m);c(e,b);s=e;for(u=s.length-4;0<=u;u-=4){var v=s[u+0],p=s[u+1],t=s[u+2],w=s[u+3],z=v^p^t^w;s[u+0]=s[u+0]^z^h[v^p];s[u+1]=s[u+1]^z^h[p^t];s[u+2]=s[u+2]^z^h[t^w];s[u+3]=s[u+3]^z^h[w^v]}a(e,d.slice(k,k+f))}n(e,m);c(e,b);a(e,d.slice(k,k+f))}else{a(e,d.slice(l,
l+f));b=q[k];c(e,b);n(e,y);for(k=l-f;k>=f;k-=f){a(e,d.slice(k,k+f));l=e;for(s=l.length-4;0<=s;s-=4){var u=l[s+0],v=l[s+1],p=l[s+2],t=l[s+3],z=u^v^p^t,A=h[z],w=h[h[A^u^p]]^z,z=h[h[A^v^t]]^z;l[s+0]=l[s+0]^w^h[u^v];l[s+1]=l[s+1]^z^h[v^p];l[s+2]=l[s+2]^w^h[p^t];l[s+3]=l[s+3]^z^h[t^u]}c(e,b);n(e,y)}a(e,d.slice(0,f))}},m=[99,124,119,123,242,107,111,197,48,1,103,43,254,215,171,118,202,130,201,125,250,89,71,240,173,212,162,175,156,164,114,192,183,253,147,38,54,63,247,204,52,165,229,241,113,216,49,21,4,199,
35,195,24,150,5,154,7,18,128,226,235,39,178,117,9,131,44,26,27,110,90,160,82,59,214,179,41,227,47,132,83,209,0,237,32,252,177,91,106,203,190,57,74,76,88,207,208,239,170,251,67,77,51,133,69,249,2,127,80,60,159,168,81,163,64,143,146,157,56,245,188,182,218,33,16,255,243,210,205,12,19,236,95,151,68,23,196,167,126,61,100,93,25,115,96,129,79,220,34,42,144,136,70,238,184,20,222,94,11,219,224,50,58,10,73,6,36,92,194,211,172,98,145,149,228,121,231,200,55,109,141,213,78,169,108,86,244,234,101,122,174,8,186,
120,37,46,28,166,180,198,232,221,116,31,75,189,139,138,112,62,181,102,72,3,246,14,97,53,87,185,134,193,29,158,225,248,152,17,105,217,142,148,155,30,135,233,206,85,40,223,140,161,137,13,191,230,66,104,65,153,45,15,176,84,187,22],t=[[0,1,2,3],[0,1,2,3],[0,1,3,4]],x=Array(3),l=0;3>l;l++){x[l]=Array(k[l]);for(var w=k[l];0<=w;w--)x[l][w]=(w+(t[l][w&3]<<2))%k[l]}for(var y=Array(256),l=0;256>l;l++)y[m[l]]=l;for(var q=Array(3),l=0;3>l;l++)for(q[l]=Array(k[l]),w=k[l];0<=w;w--)q[l][x[l][w]]=w;for(var h=Array(256),
l=0;128>l;l++)h[l]=l<<1,h[128+l]=l<<1^27;var n=function(a,c){for(var b=a.length-1;0<=b;b--)a[b]=c[a[b]]},a=function(a,c){for(var b=a.length-1;0<=b;b--)a[b]^=c[b]},c=function(a,c){for(var b=a.slice(0),f=a.length-1;0<=f;f--)a[f]=b[c[f]]};return{Encrypt:function(a,c){p(a,c,!0)},Decrypt:function(a,c){p(a,c,!1)}}};var Serpent=Serpent?Serpent:new function(){var k={},g=function(a,c){return(a<<c|a>>>32-c)&4294967295},r=function(a,c){return a[c]|a[c+1]<<8|a[c+2]<<16|a[c+3]<<24},p=function(a,c,e){a.splice(c,4,e&255,e>>>8&255,e>>>16&255,e>>>24&255)},m=[],t=function(a,c,e,d,b,f){a[c]^=m[4*f];a[e]^=m[4*f+1];a[d]^=m[4*f+2];a[b]^=m[4*f+3]},x=[function(a,c,e,d,b,f){a[f]=a[b];a[b]|=a[c];a[c]^=a[f];a[f]^=a[d];a[f]=~a[f];a[b]^=a[e];a[e]&=a[c];a[e]^=a[f];a[d]^=a[c];a[c]^=a[b];a[f]|=a[c];a[c]^=a[d];a[d]&=a[e];a[b]^=a[d];a[e]=
~a[e];a[d]^=a[f];a[e]^=a[d]},function(a,c,e,d,b,f){a[f]=a[e];a[e]^=a[c];a[c]^=a[b];a[b]=~a[b];a[f]&=a[e];a[c]|=a[e];a[b]^=a[d];a[c]^=a[b];a[e]^=a[b];a[b]^=a[f];a[e]|=a[f];a[f]^=a[d];a[d]&=a[c];a[d]^=a[e];a[e]|=a[c];a[c]=~a[c];a[c]^=a[d];a[f]^=a[e]},function(a,c,e,d,b,f){a[b]=~a[b];a[e]^=a[c];a[f]=a[c];a[c]&=a[d];a[c]^=a[b];a[b]|=a[f];a[d]^=a[e];a[b]^=a[e];a[e]&=a[c];a[c]^=a[d];a[d]&=a[b];a[b]|=a[e];a[c]=~a[c];a[b]^=a[c];a[f]^=a[c];a[c]^=a[d];a[e]|=a[d]},function(a,c,e,d,b,f){a[f]=a[e];a[e]^=a[b];
a[b]|=a[c];a[f]&=a[c];a[c]^=a[d];a[d]^=a[e];a[e]&=a[b];a[d]^=a[b];a[c]|=a[f];a[f]^=a[b];a[e]^=a[c];a[c]&=a[b];a[b]&=a[f];a[b]^=a[d];a[f]|=a[e];a[d]&=a[e];a[f]^=a[b];a[c]^=a[b];a[b]^=a[d]},function(a,c,e,d,b,f){a[f]=a[b];a[b]&=a[c];a[c]^=a[f];a[b]^=a[d];a[d]|=a[f];a[c]^=a[e];a[f]^=a[b];a[d]|=a[c];a[d]^=a[e];a[e]&=a[c];a[e]^=a[f];a[f]&=a[d];a[d]^=a[b];a[f]^=a[c];a[b]|=a[e];a[e]=~a[e];a[b]^=a[c]},function(a,c,e,d,b,f){a[f]=a[e];a[e]|=a[c];a[d]^=a[e];a[b]=~a[b];a[f]^=a[c];a[c]^=a[d];a[e]&=a[f];a[f]|=
a[b];a[f]^=a[c];a[c]&=a[b];a[e]^=a[b];a[b]^=a[d];a[c]^=a[e];a[d]&=a[f];a[e]^=a[d];a[d]&=a[c];a[b]^=a[d]},function(a,c,e,d,b,f){a[f]=a[e];a[b]^=a[c];a[e]^=a[d];a[d]^=a[c];a[c]&=a[b];a[e]|=a[b];a[f]=~a[f];a[c]^=a[e];a[e]^=a[d];a[b]^=a[f];a[f]^=a[c];a[d]&=a[c];a[f]^=a[e];a[d]^=a[b];a[b]&=a[e];a[b]^=a[c];a[e]^=a[d]},function(a,c,e,d,b,f){a[e]=~a[e];a[f]=a[e];a[c]=~a[c];a[e]&=a[d];a[e]^=a[b];a[b]|=a[f];a[f]^=a[d];a[d]^=a[b];a[b]^=a[c];a[c]|=a[e];a[d]&=a[c];a[c]^=a[f];a[f]^=a[b];a[b]&=a[c];a[f]^=a[e];a[d]^=
a[f];a[b]^=a[e];a[f]|=a[c];a[f]^=a[e]}],l=[function(a,c,e,d,b,f){a[f]=a[b];a[e]^=a[c];a[b]|=a[e];a[f]^=a[e];a[c]=~a[c];a[d]^=a[b];a[b]^=a[c];a[c]&=a[e];a[c]^=a[d];a[d]&=a[b];a[b]^=a[f];a[d]^=a[b];a[e]^=a[b];a[b]&=a[c];a[e]^=a[c];a[c]^=a[d];a[f]^=a[b]},function(a,c,e,d,b,f){a[e]^=a[b];a[f]=a[c];a[c]^=a[d];a[d]=~a[d];a[f]|=a[e];a[f]^=a[b];a[b]&=a[e];a[e]^=a[d];a[d]&=a[f];a[f]^=a[e];a[e]|=a[b];a[b]^=a[c];a[d]^=a[c];a[c]|=a[f];a[d]^=a[f];a[e]^=a[c];a[f]^=a[e]},function(a,c,e,d,b,f){a[d]^=a[e];a[f]=a[b];
a[b]=~a[b];a[b]|=a[d];a[d]^=a[f];a[f]^=a[c];a[b]^=a[e];a[e]|=a[d];a[d]^=a[c];a[e]^=a[f];a[f]|=a[b];a[d]^=a[b];a[f]^=a[d];a[d]&=a[e];a[d]^=a[b];a[b]^=a[f];a[f]^=a[c]},function(a,c,e,d,b,f){a[d]^=a[e];a[f]=a[e];a[e]&=a[d];a[e]^=a[c];a[c]|=a[f];a[f]^=a[b];a[c]^=a[b];a[b]|=a[e];a[e]^=a[d];a[e]^=a[b];a[c]^=a[d];a[d]^=a[b];a[b]&=a[e];a[e]^=a[c];a[c]&=a[d];a[f]^=a[b];a[b]^=a[c];a[c]^=a[e]},function(a,c,e,d,b,f){a[d]^=a[b];a[f]=a[c];a[c]&=a[e];a[c]^=a[d];a[d]|=a[b];a[f]=~a[f];a[e]^=a[c];a[c]^=a[d];a[d]&=
a[f];a[d]^=a[c];a[c]|=a[f];a[c]^=a[b];a[b]&=a[d];a[f]^=a[b];a[b]^=a[e];a[e]&=a[c];a[f]^=a[e];a[c]^=a[b]},function(a,c,e,d,b,f){a[f]=a[e];a[e]|=a[d];a[d]^=a[f];a[e]^=a[b];a[b]&=a[f];a[d]^=a[b];a[b]|=a[c];a[c]=~a[c];a[b]^=a[d];a[d]|=a[c];a[f]^=a[e];a[d]^=a[f];a[f]&=a[c];a[c]^=a[e];a[e]^=a[b];a[c]&=a[d];a[d]^=a[b];a[c]^=a[d];a[d]^=a[f];a[f]^=a[b]},function(a,c,e,d,b,f){a[c]^=a[d];a[f]=a[c];a[c]&=a[b];a[d]^=a[b];a[c]^=a[d];a[b]^=a[e];a[d]|=a[f];a[d]^=a[b];a[b]&=a[c];a[c]=~a[c];a[b]^=a[e];a[e]&=a[d];a[f]^=
a[c];a[b]^=a[f];a[f]^=a[d];a[c]^=a[e];a[d]^=a[c]},function(a,c,e,d,b,f){a[f]=a[b];a[b]&=a[c];a[c]^=a[d];a[d]|=a[f];a[f]^=a[e];a[c]=~a[c];a[e]|=a[b];a[f]^=a[c];a[c]&=a[d];a[c]^=a[e];a[e]&=a[d];a[b]^=a[d];a[f]^=a[b];a[d]&=a[b];a[b]|=a[c];a[e]^=a[f];a[b]^=a[f];a[f]&=a[c];a[f]^=a[d]}],w=[7788,63716,84032,7891,78949,25146,28835,67288,84032,40055,7361,1940,77639,27525,24193,75702,7361,35413,83150,82383,58619,48468,18242,66861,83150,69667,7788,31552,40054,23222,52496,57565,7788,63716],y=[44255,61867,45034,
52496,73087,56255,43827,41448,18242,1939,18581,56255,64584,31097,26469,77728,77639,4216,64585,31097,66861,78949,58006,59943,49676,78950,5512,78949,27525,52496,18670,76143],q=[44255,60896,28835,1837,1057,4216,18242,77301,47399,53992,1939,1940,66420,39172,78950,45917,82383,7450,67288,26469,83149,57565,66419,47400,58006,44254,18581,18228,33048,45034,66508,7449],h=function(a,c,e,d,b,f){m[f]=a[e]=g(m[c]^a[e]^a[d]^a[b]^2654435769^f,11)},n=function(a,c,e,d,b,f){m[f]=a[c];m[f+1]=a[e];m[f+2]=a[d];m[f+3]=a[b]};
k.Init=function(a){var c,e,d;for(32>a.length&&(a[a.length]=1);32>a.length;)a[a.length]=0;for(c=0;8>c;c++)m[c]=a[4*c+0]&255|(a[4*c+1]&255)<<8|(a[4*c+2]&255)<<16|(a[4*c+3]&255)<<24;var b=[m[3],m[4],m[5],m[6],m[7]];for(a=c=0;h(b,a++,0,4,2,c++),h(b,a++,1,0,3,c++),132>c;)h(b,a++,2,1,4,c++),8==c&&(a=0),h(b,a++,3,2,0,c++),h(b,a++,4,3,1,c++);c=128;a=3;for(d=0;e=w[d++],x[a++%8](b,e%5,e%7,e%11,e%13,e%17),e=w[d],n(b,e%5,e%7,e%11,e%13,c),0<c;){c-=4;var f=b,g=e%7,l=e%11,k=e%13,p=c;f[e%5]=m[p];f[g]=m[p+1];f[l]=
m[p+2];f[k]=m[p+3]}};k.Close=function(){m=[]};k.Encrypt=function(a){var c=a.slice(0),c=[r(c,0),r(c,4),r(c,8),r(c,12)];t(c,0,1,2,3,0);for(var e=0,d=y[e];x[e%8](c,d%5,d%7,d%11,d%13,d%17),31>e;){var d=y[++e],b=c,f=d%5,l=d%7,h=d%11,k=d%13,n=d%17,q=e;b[f]=g(b[f],13);b[h]=g(b[h],3);b[l]^=b[f];b[n]=b[f]<<3&4294967295;b[k]^=b[h];b[l]^=b[h];b[l]=g(b[l],1);b[k]^=b[n];b[k]=g(b[k],7);b[n]=b[l];b[f]^=b[l];b[n]=b[n]<<7&4294967295;b[h]^=b[k];b[f]^=b[k];b[h]^=b[n];b[k]^=m[4*q+3];b[l]^=m[4*q+1];b[f]=g(b[f],5);b[h]=
g(b[h],22);b[f]^=m[4*q+0];b[h]^=m[4*q+2]}t(c,0,1,2,3,32);p(a,0,c[0]);p(a,4,c[1]);p(a,8,c[2]);p(a,12,c[3])};k.Decrypt=function(a){var c=a.slice(0,16),c=[r(c,0),r(c,4),r(c,8),r(c,12)];t(c,0,1,2,3,32);for(var e=0,d=q[e];l[7-e%8](c,d%5,d%7,d%11,d%13,d%17),31>e;){var d=q[++e],b=c,f=d%5,h=d%7,k=d%11,n=d%13,u=d%17,v=32-e;b[f]^=m[4*v+0];b[h]^=m[4*v+1];b[k]^=m[4*v+2];b[n]^=m[4*v+3];b[f]=g(b[f],27);b[k]=g(b[k],10);b[u]=b[h];b[k]^=b[n];b[f]^=b[n];b[u]=b[u]<<7&4294967295;b[f]^=b[h];b[h]=g(b[h],31);b[k]^=b[u];
b[n]=g(b[n],25);b[u]=b[f]<<3&4294967295;b[h]^=b[f];b[n]^=b[u];b[f]=g(b[f],19);b[h]^=b[k];b[n]^=b[k];b[k]=g(b[k],29)}t(c,2,3,1,4,0);p(a,0,c[2]);p(a,4,c[3]);p(a,8,c[1]);p(a,12,c[4])};return k};var Utf8={encode:function(k){k=k.replace(/[\u0080-\u07ff]/g,function(g){g=g.charCodeAt(0);return String.fromCharCode(192|g>>6,128|g&63)});return k=k.replace(/[\u0800-\uffff]/g,function(g){g=g.charCodeAt(0);return String.fromCharCode(224|g>>12,128|g>>6&63,128|g&63)})},decode:function(k){k=k.replace(/[\u00e0-\u00ef][\u0080-\u00bf][\u0080-\u00bf]/g,function(g){g=(g.charCodeAt(0)&15)<<12|(g.charCodeAt(1)&63)<<6|g.charCodeAt(2)&63;return String.fromCharCode(g)});return k=k.replace(/[\u00c0-\u00df][\u0080-\u00bf]/g,
function(g){g=(g.charCodeAt(0)&31)<<6|g.charCodeAt(1)&63;return String.fromCharCode(g)})},fromCp1251:function(k){for(var g="",r=0,p=0;p<k.length;++p)r=k.charCodeAt(p),127<r?1024<r&&(1025==r?r=1016:1105==r&&(r=1032),g+=String.fromCharCode(r-848)):g+=k.charAt(p);return g}};var MultiCrypting=MultiCrypting?MultiCrypting:new function(){this.encode=function(k){k=Utf8.fromCp1251(k);var g=mcrypt.get_iv_size("rijndael-256","ecb"),r=mcrypt.create_iv(g),p=void 0;if(void 0===p||16!=p&&32!=p)p=32;for(var g=(new Date).getTime().toString(),m="",t=6;0<=t;--t)m+=(g[12-t]^g[7-t]).toString().substr(0,1);m=Math.abs(g>>3).toString()+m;32==p&&(m=Utils.bin2hex(m));k=mcrypt.Encrypt(k,r,m,"rijndael-256","ecb");k=Utils.bin2hex(k);g=Utils.bin2hex(g);return Base64.encode(g+k)}};
