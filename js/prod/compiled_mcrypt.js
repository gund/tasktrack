var mcrypt=mcrypt?mcrypt:new function(){var c={"rijndael-128":[16,32],"rijndael-192":[24,32],"rijndael-256":[32,32],serpent:[16,32]},e={"rijndael-128":function(c,e,h,l){32>h.length&&(h+=Array(33-h.length).join(String.fromCharCode(0)));l?Rijndael.Encrypt(e,h):Rijndael.Decrypt(e,h);return e}};e["rijndael-192"]=e["rijndael-128"];e["rijndael-256"]=e["rijndael-128"];e.serpent=function(c,e,h,l){l?Serpent.Encrypt(e):Serpent.Decrypt(e);return e};e.serpent.init=function(c,e,h){c=[];for(h=0;h<e.length;h++)c[h]=
e.charCodeAt(h);Serpent.Init(c)};e.serpent.deinit=function(c,e,h){Serpent.Close()};var l={Encrypt:function(c,e,h,p,t){return l.Crypt(!0,c,e,h,p,t)},Decrypt:function(c,e,h,p,t){return l.Crypt(!1,c,e,h,p,t)},Crypt:function(l,q,x,J,D,s){J?p=J:J=p;D?t=D:D=t;s?h=s:s=h;if(!q)return!0;e[D].init&&e[D].init(D,J,l);var u=c[D][0],B=u,G=Array(u);switch(s){case "cfb":B=1;case "cbc":case "ncfb":case "nofb":case "ctr":if(!x)throw"mcrypt.Crypt: IV Required for mode "+s;if(x.length!=u)throw"mcrypt.Crypt: IV must be "+
u+" characters long for "+D;for(u-=1;0<=u;u--)G[u]=x.charCodeAt(u);break;case "ecb":break;default:throw"mcrypt.Crypt: Unsupported mode of opperation"+h;}x=Math.ceil(q.length/B);var O=q.length;q+=Array(x*B-O+1).join(String.fromCharCode(0));var K="";switch(s){case "ecb":for(u=0;u<x;u++){for(s=0;s<B;s++)G[s]=q.charCodeAt(u*B+s);e[D](D,G,p,l);for(s=0;s<B;s++)K+=String.fromCharCode(G[s])}break;case "cbc":if(l)for(u=0;u<x;u++){for(s=0;s<B;s++)G[s]^=q.charCodeAt(u*B+s);e[D](D,G,p,!0);for(s=0;s<B;s++)K+=
String.fromCharCode(G[s])}else for(u=0;u<x;u++){var v=G,G=Array(B);for(s=0;s<B;s++)G[s]=q.charCodeAt(u*B+s);O=G.slice(0);e[D](D,O,p,!1);for(s=0;s<B;s++)K+=String.fromCharCode(v[s]^O[s])}break;case "cfb":for(u=0;u<x;u++)v=G.slice(0),e[D](D,v,p,!0),v=v[0]^q.charCodeAt(u),G.push(l?v:q.charCodeAt(u)),G.shift(),K+=String.fromCharCode(v);K=K.substr(0,O);break;case "ncfb":for(u=0;u<x;u++)for(e[D](D,G,p,!0),s=0;s<B;s++)v=q.charCodeAt(u*B+s),G[s]^=v,K+=String.fromCharCode(G[s]),l||(G[s]=v);K=K.substr(0,O);
break;case "nofb":for(u=0;u<x;u++)for(e[D](D,G,p,!0),s=0;s<B;s++)K+=String.fromCharCode(q.charCodeAt(u*B+s)^G[s]);K=K.substr(0,O);break;case "ctr":for(u=0;u<x;u++){v=G.slice(0);e[D](D,v,p,!0);for(s=0;s<B;s++)K+=String.fromCharCode(q.charCodeAt(u*B+s)^v[s]);s=1;v=B;do v--,G[v]+=1,s=G[v]>>8,G[v]&=255;while(s)}K=K.substr(0,O)}e[D].deinit&&e[D].deinit(D,J,l);return K},get_block_size:function(e,h){e||(e=t);return c[e]?c[e][0]:!1},get_cipher_name:function(e){e||(e=t);return c[e]?e:!1},get_iv_size:function(e,
h){e||(e=t);return c[e]?c[e][0]:!1},create_iv:function(c){for(var e="";c;--c)e+=String.fromCharCode(Math.floor(256*Math.random()));return e},get_key_size:function(e,h){e||(e=t);return c[e]?c[e][1]:!1},list_algorithms:function(){var e=[],h;for(h in c)e.push(h);return e},list_modes:function(){return"ecb cbc cfb ncfb nofb ctr".split(" ")}},h="cbc",t="rijndael-128",p="12345678911234567892123456789312";return l};var Rijndael=Rijndael?Rijndael:new function(){for(var c=[16,24,32],e=[[10,12,14],[12,12,14],[14,14,14]],l={},h=function(c,h,p){var q=c.length,C=h.length,x=0,E=0;switch(q){case 32:x++;case 24:x++;case 16:break;default:throw"rijndael: Unsupported block size: "+c.length;}switch(C){case 32:E++;case 24:E++;case 16:break;default:throw"rijndael: Unsupported key size: "+h.length;}C=e[x][E];if(!l[h]){var E=h.length,A=1;keyA=Array(480);for(var F=0;F<E;F++)keyA[F]=h.charCodeAt(F);for(F=E;480>F;F+=4){var I=keyA.slice(F-
4,F);0==F%E?(I=[t[I[1]]^A,t[I[2]],t[I[3]],t[I[0]]],256<=(A<<=1)&&(A^=283)):24<E&&16==F%E&&(I=[t[I[0]],t[I[1]],t[I[2]],t[I[3]]]);for(var M=0;4>M;M++)keyA[F+M]=keyA[F+M-E]^I[M]}l[h]=keyA}h=l[h];C*=q;if(p){B(c,h.slice(0,q));p=w[x];for(x=q;x<C;x+=q){u(c,t);G(c,p);E=c;for(A=E.length-4;0<=A;A-=4){var F=E[A+0],I=E[A+1],M=E[A+2],V=E[A+3],P=F^I^M^V;E[A+0]=E[A+0]^P^s[F^I];E[A+1]=E[A+1]^P^s[I^M];E[A+2]=E[A+2]^P^s[M^V];E[A+3]=E[A+3]^P^s[V^F]}B(c,h.slice(x,x+q))}u(c,t);G(c,p);B(c,h.slice(x,x+q))}else{B(c,h.slice(C,
C+q));p=D[x];G(c,p);u(c,J);for(x=C-q;x>=q;x-=q){B(c,h.slice(x,x+q));C=c;for(E=C.length-4;0<=E;E-=4){var A=C[E+0],F=C[E+1],I=C[E+2],M=C[E+3],P=A^F^I^M,ka=s[P],V=s[s[ka^A^I]]^P,P=s[s[ka^F^M]]^P;C[E+0]=C[E+0]^V^s[A^F];C[E+1]=C[E+1]^P^s[F^I];C[E+2]=C[E+2]^V^s[I^M];C[E+3]=C[E+3]^P^s[M^A]}G(c,p);u(c,J)}B(c,h.slice(0,q))}},t=[99,124,119,123,242,107,111,197,48,1,103,43,254,215,171,118,202,130,201,125,250,89,71,240,173,212,162,175,156,164,114,192,183,253,147,38,54,63,247,204,52,165,229,241,113,216,49,21,4,
199,35,195,24,150,5,154,7,18,128,226,235,39,178,117,9,131,44,26,27,110,90,160,82,59,214,179,41,227,47,132,83,209,0,237,32,252,177,91,106,203,190,57,74,76,88,207,208,239,170,251,67,77,51,133,69,249,2,127,80,60,159,168,81,163,64,143,146,157,56,245,188,182,218,33,16,255,243,210,205,12,19,236,95,151,68,23,196,167,126,61,100,93,25,115,96,129,79,220,34,42,144,136,70,238,184,20,222,94,11,219,224,50,58,10,73,6,36,92,194,211,172,98,145,149,228,121,231,200,55,109,141,213,78,169,108,86,244,234,101,122,174,8,
186,120,37,46,28,166,180,198,232,221,116,31,75,189,139,138,112,62,181,102,72,3,246,14,97,53,87,185,134,193,29,158,225,248,152,17,105,217,142,148,155,30,135,233,206,85,40,223,140,161,137,13,191,230,66,104,65,153,45,15,176,84,187,22],p=[[0,1,2,3],[0,1,2,3],[0,1,3,4]],w=Array(3),q=0;3>q;q++){w[q]=Array(c[q]);for(var x=c[q];0<=x;x--)w[q][x]=(x+(p[q][x&3]<<2))%c[q]}for(var J=Array(256),q=0;256>q;q++)J[t[q]]=q;for(var D=Array(3),q=0;3>q;q++)for(D[q]=Array(c[q]),x=c[q];0<=x;x--)D[q][w[q][x]]=x;for(var s=
Array(256),q=0;128>q;q++)s[q]=q<<1,s[128+q]=q<<1^27;var u=function(c,e){for(var h=c.length-1;0<=h;h--)c[h]=e[c[h]]},B=function(c,e){for(var h=c.length-1;0<=h;h--)c[h]^=e[h]},G=function(c,e){for(var h=c.slice(0),l=c.length-1;0<=l;l--)c[l]=h[e[l]]};return{Encrypt:function(c,e){h(c,e,!0)},Decrypt:function(c,e){h(c,e,!1)}}};var MultiCrypting=MultiCrypting?MultiCrypting:new function(){this.encode=function(c){c=Utf8.fromCp1251(c);var e=mcrypt.get_iv_size("rijndael-256","ecb"),l=mcrypt.create_iv(e),h=void 0;if(void 0===h||16!=h&&32!=h)h=32;for(var e=(new Date).getTime().toString(),t="",p=6;0<=p;--p)t+=(e[12-p]^e[7-p]).toString().substr(0,1);t=Math.abs(e>>3).toString()+t;32==h&&(t=Utils.bin2hex(t));c=mcrypt.Encrypt(c,l,t,"rijndael-256","ecb");c=Utils.bin2hex(c);e=Utils.bin2hex(e);return Base64.encode(e+c)}};
